@model Corum.Models.ViewModels.Orders.OrderProjectViewModel

@{
    ViewBag.Title = "NewProject";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("NewProject", "Projects", FormMethod.Post))
{
    <div class="form-horizontal">
        <h4>Создание нового проекта</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        @Html.HiddenFor(model => model.Id, new { htmlAttributes = new { @class = "form-control" } })

        @Html.Partial("_ProjectDetails")


        <div class="form-group">         
            <input type="submit" value="Создать" class="btn btn-default" />
        </div>
        @Html.Partial("~/Views/Shared/_GetOrganizations.cshtml")
    </div>
}

@section scripts
{

    <script>
        $(document).ready(function() {
            InitializeDateTimePickers();
            InitFilterDropDowns();
            InitializeOrganizations();

            var ProjectTypeIdvalue = $(ProjectTypeId).val();
            if (ProjectTypeIdvalue == '1') {
                $("#PNumOrder").css('display', 'block');
                $("#PDateOpenOrder").css('display', 'block');
                $("#Prow").css('display', 'block');
                $("#Phr").css('display', 'block');
                $("#Phr2").css('display', 'block');
                $("#Prow2").css('display', 'block');
                $("#Prow3").css('display', 'block');
            }
            else {
                $("#PNumOrder").css('display', 'none');
                $("#PDateOpenOrder").css('display', 'none');
                $("#Prow").css('display', 'none');
                $("#Phr").css('display', 'none');
                $("#Phr2").css('display', 'none');
                $("#Prow2").css('display', 'none');
                $("#Prow3").css('display', 'none');
            }

            $('#ProjectTypeId').change(function() {
                debugger;
                var value = $(this).val();
                if (value == '1') {
                    $("#PNumOrder").css('display', 'block');
                    $("#PDateOpenOrder").css('display', 'block');
                    $("#Prow").css('display', 'block');
                    $("#Phr").css('display', 'block');
                    $("#Phr2").css('display', 'block');
                    $("#Prow2").css('display', 'block');
                    $("#Prow3").css('display', 'block');
                }
                else {
                    $("#PNumOrder").css('display', 'none');
                    $("#PDateOpenOrder").css('display', 'none');
                    $("#Prow").css('display', 'none');
                    $("#Phr").css('display', 'none');
                    $("#Phr2").css('display', 'none');
                    $("#Prow2").css('display', 'none');
                    $("#Prow3").css('display', 'none');
                }
            });
        });

        $("#ShowOrgFrom").on("click", function () {
            var initFields = function (obj) {
                $('#ShipperName').val(obj._Name);
                $('#Shipper').val(obj._Id);
            };

            ShowOrganizationDlg(initFields);
        });

        $("#ShowOrgTo").on("click", function () {
            var initFields = function (obj) {
                $('#ConsigneeName').val(obj._Name);
                $('#Consignee').val(obj._Id);
            };

            ShowOrganizationDlg(initFields);
        });
    </script>
}